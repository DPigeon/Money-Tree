<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="636px" preserveAspectRatio="none" style="width:1692px;height:636px;" version="1.1" viewBox="0 0 1692 636" width="1692px" zoomAndPan="magnify"><defs><filter height="300%" id="f1b54cw9n5cvbm" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[73a39ff06bfd21a4a8df8317230e2ab5]
cluster facade--><polygon fill="#FFFFFF" filter="url(#f1b54cw9n5cvbm)" points="16,6,69,6,76,29.6094,1675,29.6094,1675,629,16,629,16,6" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="16" x2="76" y1="29.6094" y2="29.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="47" x="20" y="22.5332">facade</text><!--MD5=[b270f48c06037429ff0fb68acc9c469c]
class AlpacaSession--><rect codeLine="3" fill="#FEFECE" filter="url(#f1b54cw9n5cvbm)" height="75.6719" id="AlpacaSession" style="stroke:#A80036;stroke-width:1.5;" width="268" x="293" y="76.5"/><ellipse cx="381.25" cy="92.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M384.0156,88.375 Q384.1719,88.1563 384.3594,88.0469 Q384.5469,87.9375 384.7656,87.9375 Q385.1406,87.9375 385.375,88.2031 Q385.6094,88.4531 385.6094,89.0625 L385.6094,90.5156 Q385.6094,91.125 385.375,91.3906 Q385.1406,91.6563 384.7656,91.6563 Q384.4219,91.6563 384.2188,91.4531 Q384.0156,91.2656 383.9063,90.75 Q383.8594,90.3906 383.6719,90.2031 Q383.3438,89.8281 382.7344,89.6094 Q382.125,89.3906 381.5,89.3906 Q380.7344,89.3906 380.0938,89.7188 Q379.4688,90.0469 378.9688,90.7969 Q378.4844,91.5469 378.4844,92.5781 L378.4844,93.6719 Q378.4844,94.9063 379.375,95.7344 Q380.2656,96.5469 381.8594,96.5469 Q382.7969,96.5469 383.4531,96.2969 Q383.8438,96.1406 384.2656,95.7031 Q384.5313,95.4375 384.6719,95.3594 Q384.8281,95.2813 385.0313,95.2813 Q385.3594,95.2813 385.6094,95.5469 Q385.875,95.7969 385.875,96.1406 Q385.875,96.4844 385.5313,96.8906 Q385.0313,97.4688 384.2344,97.7969 Q383.1563,98.25 381.8594,98.25 Q380.3438,98.25 379.1406,97.625 Q378.1563,97.125 377.4688,96.0625 Q376.7813,94.9844 376.7813,93.7031 L376.7813,92.5469 Q376.7813,91.2188 377.3906,90.0781 Q378.0156,88.9219 379.1094,88.3125 Q380.2031,87.6875 381.4375,87.6875 Q382.1719,87.6875 382.8125,87.8594 Q383.4688,88.0156 384.0156,88.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="83" x="401.75" y="97.4102">AlpacaSession</text><line style="stroke:#A80036;stroke-width:1.5;" x1="294" x2="560" y1="108.5" y2="108.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="301" y="116.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="313" y="123.9189">static final Logger</text><line style="stroke:#A80036;stroke-width:1.5;" x1="294" x2="560" y1="130.3359" y2="130.3359"/><polygon fill="#4177AF" points="304,137.3359,300,143.3359,308,143.3359" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="242" x="313" y="145.7549">AlpacaAPI alpaca(String userId, String alpacaKey)</text><!--MD5=[9bee3fa839f41ab25d715e7a68246047]
class AmazonS3Facade--><rect codeLine="7" fill="#FEFECE" filter="url(#f1b54cw9n5cvbm)" height="144.8516" id="AmazonS3Facade" style="stroke:#A80036;stroke-width:1.5;" width="345" x="596.5" y="42"/><ellipse cx="714.75" cy="58" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M717.5156,53.875 Q717.6719,53.6563 717.8594,53.5469 Q718.0469,53.4375 718.2656,53.4375 Q718.6406,53.4375 718.875,53.7031 Q719.1094,53.9531 719.1094,54.5625 L719.1094,56.0156 Q719.1094,56.625 718.875,56.8906 Q718.6406,57.1563 718.2656,57.1563 Q717.9219,57.1563 717.7188,56.9531 Q717.5156,56.7656 717.4063,56.25 Q717.3594,55.8906 717.1719,55.7031 Q716.8438,55.3281 716.2344,55.1094 Q715.625,54.8906 715,54.8906 Q714.2344,54.8906 713.5938,55.2188 Q712.9688,55.5469 712.4688,56.2969 Q711.9844,57.0469 711.9844,58.0781 L711.9844,59.1719 Q711.9844,60.4063 712.875,61.2344 Q713.7656,62.0469 715.3594,62.0469 Q716.2969,62.0469 716.9531,61.7969 Q717.3438,61.6406 717.7656,61.2031 Q718.0313,60.9375 718.1719,60.8594 Q718.3281,60.7813 718.5313,60.7813 Q718.8594,60.7813 719.1094,61.0469 Q719.375,61.2969 719.375,61.6406 Q719.375,61.9844 719.0313,62.3906 Q718.5313,62.9688 717.7344,63.2969 Q716.6563,63.75 715.3594,63.75 Q713.8438,63.75 712.6406,63.125 Q711.6563,62.625 710.9688,61.5625 Q710.2813,60.4844 710.2813,59.2031 L710.2813,58.0469 Q710.2813,56.7188 710.8906,55.5781 Q711.5156,54.4219 712.6094,53.8125 Q713.7031,53.1875 714.9375,53.1875 Q715.6719,53.1875 716.3125,53.3594 Q716.9688,53.5156 717.5156,53.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="100" x="735.25" y="62.9102">AmazonS3Facade</text><line style="stroke:#A80036;stroke-width:1.5;" x1="597.5" x2="940.5" y1="74" y2="74"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="604.5" y="82"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="616.5" y="89.4189">static final Logger</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="604.5" y="95.8359"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="616.5" y="103.2549">final AmazonS3 s3</text><line style="stroke:#A80036;stroke-width:1.5;" x1="597.5" x2="940.5" y1="109.6719" y2="109.6719"/><polygon fill="#4177AF" points="607.5,116.6719,603.5,122.6719,611.5,122.6719" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="273" x="616.5" y="125.0908">AmazonS3Facade (String accessKey, String secretKey)</text><polygon fill="#4177AF" points="607.5,130.5078,603.5,136.5078,611.5,136.5078" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="319" x="616.5" y="138.9268">String uploadImageToS3Bucket (MultipartFile f, String bucketName)</text><polygon fill="#4177AF" points="607.5,144.3438,603.5,150.3438,611.5,150.3438" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="208" x="616.5" y="152.7627">File convertMultiPartToFile (MultipartFile file)</text><polygon fill="#4177AF" points="607.5,158.1797,603.5,164.1797,611.5,164.1797" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="200" x="616.5" y="166.5986">void cleanUpLocalFileCreated (File image)</text><polygon fill="#4177AF" points="607.5,172.0156,603.5,178.0156,611.5,178.0156" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="300" x="616.5" y="180.4346">void deleteImageFromS3Bucket (String bucketName, String url)</text><!--MD5=[dbd744789a27dfb7a38205596e031569]
class EmailSender--><rect codeLine="16" fill="#FEFECE" filter="url(#f1b54cw9n5cvbm)" height="117.1797" id="EmailSender" style="stroke:#A80036;stroke-width:1.5;" width="330" x="977" y="56"/><ellipse cx="1101.75" cy="72" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1104.5156,67.875 Q1104.6719,67.6563 1104.8594,67.5469 Q1105.0469,67.4375 1105.2656,67.4375 Q1105.6406,67.4375 1105.875,67.7031 Q1106.1094,67.9531 1106.1094,68.5625 L1106.1094,70.0156 Q1106.1094,70.625 1105.875,70.8906 Q1105.6406,71.1563 1105.2656,71.1563 Q1104.9219,71.1563 1104.7188,70.9531 Q1104.5156,70.7656 1104.4063,70.25 Q1104.3594,69.8906 1104.1719,69.7031 Q1103.8438,69.3281 1103.2344,69.1094 Q1102.625,68.8906 1102,68.8906 Q1101.2344,68.8906 1100.5938,69.2188 Q1099.9688,69.5469 1099.4688,70.2969 Q1098.9844,71.0469 1098.9844,72.0781 L1098.9844,73.1719 Q1098.9844,74.4063 1099.875,75.2344 Q1100.7656,76.0469 1102.3594,76.0469 Q1103.2969,76.0469 1103.9531,75.7969 Q1104.3438,75.6406 1104.7656,75.2031 Q1105.0313,74.9375 1105.1719,74.8594 Q1105.3281,74.7813 1105.5313,74.7813 Q1105.8594,74.7813 1106.1094,75.0469 Q1106.375,75.2969 1106.375,75.6406 Q1106.375,75.9844 1106.0313,76.3906 Q1105.5313,76.9688 1104.7344,77.2969 Q1103.6563,77.75 1102.3594,77.75 Q1100.8438,77.75 1099.6406,77.125 Q1098.6563,76.625 1097.9688,75.5625 Q1097.2813,74.4844 1097.2813,73.2031 L1097.2813,72.0469 Q1097.2813,70.7188 1097.8906,69.5781 Q1098.5156,68.4219 1099.6094,67.8125 Q1100.7031,67.1875 1101.9375,67.1875 Q1102.6719,67.1875 1103.3125,67.3594 Q1103.9688,67.5156 1104.5156,67.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="72" x="1122.25" y="76.9102">EmailSender</text><line style="stroke:#A80036;stroke-width:1.5;" x1="978" x2="1306" y1="88" y2="88"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="985" y="96"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="997" y="103.4189">static final Logger</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="197" x="997" y="117.2549">@Autowired JavaMailSender mailSender</text><line style="stroke:#A80036;stroke-width:1.5;" x1="978" x2="1306" y1="123.6719" y2="123.6719"/><polygon fill="#4177AF" points="988,130.6719,984,136.6719,992,136.6719" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="304" x="997" y="139.0908">void sendOrderCompletedEmail (User user, TradeUpdate trade)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="985" y="145.5078"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="240" x="997" y="152.9268">Mail constructMail (User user, TradeUpdate trade)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="985" y="159.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="225" x="997" y="166.7627">void send (String to, String subject, String text)</text><!--MD5=[eb51aee20e1c0daae8f012eb598a3615]
class MarketInteractionsFacade--><rect codeLine="23" fill="#FEFECE" filter="url(#f1b54cw9n5cvbm)" height="366.2266" id="MarketInteractionsFacade" style="stroke:#A80036;stroke-width:1.5;" width="789" x="32.5" y="247"/><ellipse cx="352.25" cy="263" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M355.0156,258.875 Q355.1719,258.6563 355.3594,258.5469 Q355.5469,258.4375 355.7656,258.4375 Q356.1406,258.4375 356.375,258.7031 Q356.6094,258.9531 356.6094,259.5625 L356.6094,261.0156 Q356.6094,261.625 356.375,261.8906 Q356.1406,262.1563 355.7656,262.1563 Q355.4219,262.1563 355.2188,261.9531 Q355.0156,261.7656 354.9063,261.25 Q354.8594,260.8906 354.6719,260.7031 Q354.3438,260.3281 353.7344,260.1094 Q353.125,259.8906 352.5,259.8906 Q351.7344,259.8906 351.0938,260.2188 Q350.4688,260.5469 349.9688,261.2969 Q349.4844,262.0469 349.4844,263.0781 L349.4844,264.1719 Q349.4844,265.4063 350.375,266.2344 Q351.2656,267.0469 352.8594,267.0469 Q353.7969,267.0469 354.4531,266.7969 Q354.8438,266.6406 355.2656,266.2031 Q355.5313,265.9375 355.6719,265.8594 Q355.8281,265.7813 356.0313,265.7813 Q356.3594,265.7813 356.6094,266.0469 Q356.875,266.2969 356.875,266.6406 Q356.875,266.9844 356.5313,267.3906 Q356.0313,267.9688 355.2344,268.2969 Q354.1563,268.75 352.8594,268.75 Q351.3438,268.75 350.1406,268.125 Q349.1563,267.625 348.4688,266.5625 Q347.7813,265.4844 347.7813,264.2031 L347.7813,263.0469 Q347.7813,261.7188 348.3906,260.5781 Q349.0156,259.4219 350.1094,258.8125 Q351.2031,258.1875 352.4375,258.1875 Q353.1719,258.1875 353.8125,258.3594 Q354.4688,258.5156 355.0156,258.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="141" x="372.75" y="267.9102">MarketInteractionsFacade</text><line style="stroke:#A80036;stroke-width:1.5;" x1="33.5" x2="820.5" y1="279" y2="279"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="287"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="132" x="52.5" y="294.4189">static final Logger LOGGER</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="300.8359"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="109" x="52.5" y="308.2549">final UserDao userDao</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="314.6719"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="101" x="52.5" y="322.0908">AlpacaAPI alpacaAPI</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="328.5078"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="275" x="52.5" y="335.9268">final Map&lt;String, AlpacaStreamListener&gt; userIdToStream</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="342.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="201" x="52.5" y="349.7627">final Map&lt;String, Boolean&gt; updateTracker</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="159" x="52.5" y="363.5986">@Autowired StockDao stockDao</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="217" x="52.5" y="377.4346">@Autowired TransactionDao transactionDao</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="158" x="52.5" y="391.2705">@Autowired MadeDao madeDao</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="164" x="52.5" y="405.1064">@Autowired OwnsDao ownsDao</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="52.5" y="418.9424">@Autowired EmailSender emailSender</text><line style="stroke:#A80036;stroke-width:1.5;" x1="33.5" x2="820.5" y1="425.3594" y2="425.3594"/><ellipse cx="43.5" cy="436.3594" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="286" x="52.5" y="440.7783">@Autowired MarketInteractionsFacade (UserDao userDao)</text><polygon fill="#4177AF" points="43.5,446.1953,39.5,452.1953,47.5,452.1953" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="205" x="52.5" y="454.6143">void initializeAlpacaSession (String userId)</text><polygon fill="#4177AF" points="43.5,460.0313,39.5,466.0313,47.5,466.0313" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="172" x="52.5" y="468.4502">Account getAccount (String userId)</text><polygon fill="#4177AF" points="43.5,473.8672,39.5,479.8672,47.5,479.8672" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="52.5" y="482.2861">Clock getMarketClock (String userId)</text><polygon fill="#4177AF" points="43.5,487.7031,39.5,493.7031,47.5,493.7031" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="225" x="52.5" y="496.1221">List&lt;Position&gt; getOpenPositions (String userId)</text><polygon fill="#4177AF" points="43.5,501.5391,39.5,507.5391,47.5,507.5391" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="763" x="52.5" y="509.958">PortfolioHistory getPortfolioHistory (String userId, int periodLength, int periodLength, String periodUnit, String timeFrame, tring dateEnd, boolean extendedHours)</text><polygon fill="#4177AF" points="43.5,515.375,39.5,521.375,47.5,521.375" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="412" x="52.5" y="523.7939">void listenToStreamUpdates (String userId, SimpMessagingTemplate messageSender)</text><polygon fill="#4177AF" points="43.5,529.2109,39.5,535.2109,47.5,535.2109" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="206" x="52.5" y="537.6299">void disconnectFromStream (String userId)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="544.0469"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="491" x="52.5" y="551.4658">AlpacaStreamListener createStreamListener (String userId, SimpMessagingTemplate messageSender,</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="557.8828"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="407" x="52.5" y="565.3018">void updateTransactionStatus (String clientOrderId, String avgPrice, String totalPrice)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="571.7188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="260" x="52.5" y="579.1377">void changeStatusAndSave (Transaction transaction)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="585.5547"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="317" x="52.5" y="592.9736">void sendOrderCompletedEmail (String userId, TradeUpdate trade)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="599.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="52.5" y="606.8096">User getUserById (Long userId)</text><!--MD5=[ddf190d6a6023f80211803e30f26e454]
class StockMarketDataFacade--><rect codeLine="49" fill="#FEFECE" filter="url(#f1b54cw9n5cvbm)" height="186.3594" id="StockMarketDataFacade" style="stroke:#A80036;stroke-width:1.5;" width="359" x="856.5" y="337"/><ellipse cx="965.25" cy="353" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M968.0156,348.875 Q968.1719,348.6563 968.3594,348.5469 Q968.5469,348.4375 968.7656,348.4375 Q969.1406,348.4375 969.375,348.7031 Q969.6094,348.9531 969.6094,349.5625 L969.6094,351.0156 Q969.6094,351.625 969.375,351.8906 Q969.1406,352.1563 968.7656,352.1563 Q968.4219,352.1563 968.2188,351.9531 Q968.0156,351.7656 967.9063,351.25 Q967.8594,350.8906 967.6719,350.7031 Q967.3438,350.3281 966.7344,350.1094 Q966.125,349.8906 965.5,349.8906 Q964.7344,349.8906 964.0938,350.2188 Q963.4688,350.5469 962.9688,351.2969 Q962.4844,352.0469 962.4844,353.0781 L962.4844,354.1719 Q962.4844,355.4063 963.375,356.2344 Q964.2656,357.0469 965.8594,357.0469 Q966.7969,357.0469 967.4531,356.7969 Q967.8438,356.6406 968.2656,356.2031 Q968.5313,355.9375 968.6719,355.8594 Q968.8281,355.7813 969.0313,355.7813 Q969.3594,355.7813 969.6094,356.0469 Q969.875,356.2969 969.875,356.6406 Q969.875,356.9844 969.5313,357.3906 Q969.0313,357.9688 968.2344,358.2969 Q967.1563,358.75 965.8594,358.75 Q964.3438,358.75 963.1406,358.125 Q962.1563,357.625 961.4688,356.5625 Q960.7813,355.4844 960.7813,354.2031 L960.7813,353.0469 Q960.7813,351.7188 961.3906,350.5781 Q962.0156,349.4219 963.1094,348.8125 Q964.2031,348.1875 965.4375,348.1875 Q966.1719,348.1875 966.8125,348.3594 Q967.4688,348.5156 968.0156,348.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="133" x="985.75" y="357.9102">StockMarketDataFacade</text><line style="stroke:#A80036;stroke-width:1.5;" x1="857.5" x2="1214.5" y1="369" y2="369"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="864.5" y="377"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="200" x="876.5" y="384.4189">final IEXCloudClient stockMarketDataClient</text><line style="stroke:#A80036;stroke-width:1.5;" x1="857.5" x2="1214.5" y1="390.8359" y2="390.8359"/><ellipse cx="867.5" cy="401.8359" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="333" x="876.5" y="406.2549">StockMarketDataFacade( String pToken, String sToken, String profile)</text><polygon fill="#4177AF" points="867.5,411.6719,863.5,417.6719,871.5,417.6719" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="255" x="876.5" y="420.0908">BatchStock getBatchStocksBySymbol(String symbol)</text><polygon fill="#4177AF" points="867.5,425.5078,863.5,431.5078,871.5,431.5078" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="876.5" y="433.9268">Book getBook (String symbol)</text><polygon fill="#4177AF" points="867.5,439.3438,863.5,445.3438,871.5,445.3438" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149" x="876.5" y="447.7627">Quote getQuote(String symbol)</text><polygon fill="#4177AF" points="867.5,453.1797,863.5,459.1797,871.5,459.1797" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="199" x="876.5" y="461.5986">Company getCompanyInfo(String symbol)</text><polygon fill="#4177AF" points="867.5,467.0156,863.5,473.0156,871.5,473.0156" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="250" x="876.5" y="475.4346">List&lt;News&gt; getLastNNews(String symbol, int lastN)</text><polygon fill="#4177AF" points="867.5,480.8516,863.5,486.8516,871.5,486.8516" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="179" x="876.5" y="489.2705">KeyStats getKeyStats(String symbol)</text><polygon fill="#4177AF" points="867.5,494.6875,863.5,500.6875,871.5,500.6875" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="237" x="876.5" y="503.1064">List&lt;Chart&gt; getChart(String symbol, String range)</text><polygon fill="#4177AF" points="867.5,508.5234,863.5,514.5234,871.5,514.5234" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="139" x="876.5" y="516.9424">Logo getLogo(String symbol)</text><!--MD5=[9aef4140be482798edb6834a607f9683]
class YahooFinanceService--><rect codeLine="63" fill="#FEFECE" filter="url(#f1b54cw9n5cvbm)" height="89.5078" id="YahooFinanceService" style="stroke:#A80036;stroke-width:1.5;" width="408" x="1251" y="385"/><ellipse cx="1391.25" cy="401" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1394.0156,396.875 Q1394.1719,396.6563 1394.3594,396.5469 Q1394.5469,396.4375 1394.7656,396.4375 Q1395.1406,396.4375 1395.375,396.7031 Q1395.6094,396.9531 1395.6094,397.5625 L1395.6094,399.0156 Q1395.6094,399.625 1395.375,399.8906 Q1395.1406,400.1563 1394.7656,400.1563 Q1394.4219,400.1563 1394.2188,399.9531 Q1394.0156,399.7656 1393.9063,399.25 Q1393.8594,398.8906 1393.6719,398.7031 Q1393.3438,398.3281 1392.7344,398.1094 Q1392.125,397.8906 1391.5,397.8906 Q1390.7344,397.8906 1390.0938,398.2188 Q1389.4688,398.5469 1388.9688,399.2969 Q1388.4844,400.0469 1388.4844,401.0781 L1388.4844,402.1719 Q1388.4844,403.4063 1389.375,404.2344 Q1390.2656,405.0469 1391.8594,405.0469 Q1392.7969,405.0469 1393.4531,404.7969 Q1393.8438,404.6406 1394.2656,404.2031 Q1394.5313,403.9375 1394.6719,403.8594 Q1394.8281,403.7813 1395.0313,403.7813 Q1395.3594,403.7813 1395.6094,404.0469 Q1395.875,404.2969 1395.875,404.6406 Q1395.875,404.9844 1395.5313,405.3906 Q1395.0313,405.9688 1394.2344,406.2969 Q1393.1563,406.75 1391.8594,406.75 Q1390.3438,406.75 1389.1406,406.125 Q1388.1563,405.625 1387.4688,404.5625 Q1386.7813,403.4844 1386.7813,402.2031 L1386.7813,401.0469 Q1386.7813,399.7188 1387.3906,398.5781 Q1388.0156,397.4219 1389.1094,396.8125 Q1390.2031,396.1875 1391.4375,396.1875 Q1392.1719,396.1875 1392.8125,396.3594 Q1393.4688,396.5156 1394.0156,396.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="119" x="1411.75" y="405.9102">YahooFinanceService</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1252" x2="1658" y1="417" y2="417"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1259" y="425"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="1271" y="432.4189">final WebClient webClient</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1252" x2="1658" y1="438.8359" y2="438.8359"/><ellipse cx="1262" cy="449.8359" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="282" x="1271" y="454.2549">YahooFinanceFacade(WebClient.Builder webClientBuilder)</text><polygon fill="#4177AF" points="1262,459.6719,1258,465.6719,1266,465.6719" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="382" x="1271" y="468.0908">Mono&lt;String&gt; getHistoricalGraphData(String ticker, String range, String interval)</text><!--MD5=[5e1352c6bc370471d6592b4b659bda2e]
link AlpacaSession to AmazonS3Facade--><!--MD5=[066dc6d69f4a18fb791bc57ff94c54ce]
link AmazonS3Facade to EmailSender--><!--MD5=[b9b3bb7c3bdcac23cebdbca18aec0746]
link AlpacaSession to MarketInteractionsFacade--><!--MD5=[8bc5b1791b73f628e04fdc52d4dbe06f]
link MarketInteractionsFacade to StockMarketDataFacade--><!--MD5=[5dec17e3da1c3edcf2b7177208a61e8d]
link StockMarketDataFacade to YahooFinanceService--><!--MD5=[63e27e6b3e78c2e452c6073f576c78f1]
@startuml

package facade {
       class AlpacaSession {
              -static final Logger
              ~AlpacaAPI alpaca(String userId, String alpacaKey)
       }
       class AmazonS3Facade {
              -static final Logger
              -final AmazonS3 s3
              ~AmazonS3Facade (String accessKey, String secretKey)
              ~String uploadImageToS3Bucket (MultipartFile f, String bucketName)
              ~File convertMultiPartToFile (MultipartFile file)
              ~void cleanUpLocalFileCreated (File image)
              ~void deleteImageFromS3Bucket (String bucketName, String url)
       }
       class EmailSender {
              -static final Logger
              @Autowired JavaMailSender mailSender
              ~void sendOrderCompletedEmail (User user, TradeUpdate trade)
              -Mail constructMail (User user, TradeUpdate trade)
              -void send (String to, String subject, String text)
       }
       class MarketInteractionsFacade {
              -static final Logger LOGGER
              -final UserDao userDao
              -AlpacaAPI alpacaAPI
              -final Map<String, AlpacaStreamListener> userIdToStream
              -final Map<String, Boolean> updateTracker
              @Autowired StockDao stockDao
              @Autowired TransactionDao transactionDao
              @Autowired MadeDao madeDao
              @Autowired OwnsDao ownsDao
              @Autowired EmailSender emailSender
              +@Autowired MarketInteractionsFacade (UserDao userDao)
              ~void initializeAlpacaSession (String userId)
              ~Account getAccount (String userId)
              ~Clock getMarketClock (String userId)
              ~List<Position> getOpenPositions (String userId)
              ~PortfolioHistory getPortfolioHistory (String userId, int periodLength, int periodLength, String periodUnit, String timeFrame, tring dateEnd, boolean extendedHours)
              ~void listenToStreamUpdates (String userId, SimpMessagingTemplate messageSender)
              ~void disconnectFromStream (String userId)
              -AlpacaStreamListener createStreamListener (String userId, SimpMessagingTemplate messageSender,
              -void updateTransactionStatus (String clientOrderId, String avgPrice, String totalPrice)
              -void changeStatusAndSave (Transaction transaction)
              -void sendOrderCompletedEmail (String userId, TradeUpdate trade)
              -User getUserById (Long userId)
       }

       class StockMarketDataFacade {
              -final IEXCloudClient stockMarketDataClient
              +StockMarketDataFacade( String pToken, String sToken, String profile)
              ~BatchStock getBatchStocksBySymbol(String symbol)
              ~Book getBook (String symbol)
              ~Quote getQuote(String symbol)
              ~Company getCompanyInfo(String symbol)
              ~List<News> getLastNNews(String symbol, int lastN)
              ~KeyStats getKeyStats(String symbol)
              ~List<Chart> getChart(String symbol, String range)
              ~Logo getLogo(String symbol)

       }

       class YahooFinanceService {
              -final WebClient webClient
              +YahooFinanceFacade(WebClient.Builder webClientBuilder)
              ~Mono<String> getHistoricalGraphData(String ticker, String range, String interval)
       }


}

@enduml

PlantUML version 1.2021.00(Sun Jan 10 02:25:05 PST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>